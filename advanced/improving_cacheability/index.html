<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Middleman: Improving Cacheability</title>
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Source+Code+Pro">
    <link href="/stylesheets/site.css" rel="stylesheet" />
  </head>
  <body>
      <header id="header">
    <nav class="global-nav" role="navigation">
  <section class="wrap-container">
    <header class="global-nav-item logo-text">
      <a class="global-nav-middleman-signature" href="/">Middleman</a>
      <a class="global-nav-middleman-logo" href="/"><img src="/images/middleman-logo.svg" /></a>
    </header>

    <ul class="global-nav-list">
      <li class="global-nav-item">
        <a href="/community/">Contribute</a>
      </li>
      <li class="global-nav-item">
        <a class="cta-link-nav" href="/basics/install/">Docs</a>
      </li>
    </ul>
  </section>
</nav>

  </header>

  <div class="body-content-container wrap-container" role="main">
    <nav id="toc" class="sidebar" data-waypoint="sidebar">
      <div id="search" role="search">
  <form>
    <input class="st-search-input" id="st-search-input" type="search" placeholder="Search the docs">
  </form>
  <div id="st-results-container"></div>
  <script>
    var Swiftype = window.Swiftype || {};
    (function() {
    Swiftype.key = 'q3qjGN5LmX2oq6w1V47y';
    Swiftype.inputElement = '#st-search-input';
    Swiftype.resultContainingElement = '#st-results-container';
    Swiftype.attachElement = '#st-search-input';
    Swiftype.renderStyle = "overlay";

    var script = document.createElement('script');
    script.type = 'text/javascript';
    script.async = true;
    script.src = "//swiftype.com/embed.js";
    var entry = document.getElementsByTagName('script')[0];
    entry.parentNode.insertBefore(script, entry);
    }());
  </script>
</div>

<div class="toc-block-container">
  <div class="toc-block">
    <h3 class="docs-section-heading">Basics</h3>
    <ul>
      <li class="doc-item">
        <a href="/basics/install/">Install</a> </li>
      <li class="doc-item">
        <a href="/basics/upgrade-v4/">Upgrading to v4</a> </li>
      <li class="doc-item">
        <a href="/basics/start_new_site/">Start a New Site</a>
      </li>
      <li class="doc-item">
        <a href="/basics/directory-structure/">Directory Structure</a>
      </li>
      <li class="doc-item" >
        <a href="/basics/development_cycle/">Development Cycle</a>
      </li>
      <li class="doc-item">
        <a href="/basics/build_and_deploy/">Build & Deploy</a>
        </li>
      <li class="doc-item">
        <a href="/basics/frontmatter/">Frontmatter</a>
        </li>
      <li class="doc-item">
        <a href="/basics/templating_language/">Templating Language</a>
        </li>
      <li class="doc-item">
        <a href="/basics/helper_methods/">Helper Methods</a>
        </li>
      <li class="doc-item">
        <a href="/basics/layouts/">Layouts</a>
        </li>
      <li class="doc-item">
        <a href="/basics/partials/">Partials</a>
        </li>
      <li class="doc-item">
        <a href="/basics/blogging/">Blogging</a>
        </li>
    </ul>
  </div>

  <div class="toc-block">
    <h3 class="docs-section-heading">Advanced</h3>
    <ul>
      <li class="doc-item">
        <a href="/advanced/configuration/">Configuring Your Site</a>
        </li>
      <li class="doc-item">
        <a href="/advanced/project_templates/">Project Templates</a>
        </li>
      <li class="doc-item">
        <a href="/advanced/dynamic_pages/">Dynamic Pages</a>
        </li>
      <li class="doc-item">
        <a href="/advanced/data_files/">Data Files</a>
        </li>
      <li class="doc-item">
        <a href="/advanced/localization/">Localization (i18n)</a>
        </li>
      <li class="doc-item">
        <a href="/advanced/asset_pipeline/">Asset Pipeline</a>
        </li>
      <li class="doc-item">
        <a href="/advanced/rack_middleware/">Rack Middleware</a>
        </li>
      <li class="doc-item">
        <a href="/advanced/sitemap/">The Sitemap</a>
        </li>
      <li class="doc-item">
        <a href="/advanced/pretty_urls/">Pretty URLs (Directory Indexes)</a>
        </li>
      <li class="doc-item">
        <a href="/advanced/improving_cacheability/">Improving Cacheability</a>
        </li>
      <li class="doc-item">
        <a href="/advanced/file_size_optimization/">File Size Optimization</a>
        </li>
      <li class="doc-item">
        <a href="/advanced/custom_extensions/">Custom Extensions</a>
        </li>
    </ul>
  </div>

  <div class="toc-block">
    <h3 class="docs-section-heading">Open-Source Community</h3>
    <ul>
      <li class="doc-item">
        <a href="https://directory.middlemanapp.com/#/extensions/all/">Custom Extensions</a>
      </li>
      <li class="doc-item">
        <a href="https://directory.middlemanapp.com/#/templates/all/">Project Templates</a>
        </li>
      <li class="doc-item">
        <a href="https://directory.middlemanapp.com/#/extensions/deployment/">Deployment Solution</a>
        </li>
      <li class="doc-item">
        <a target="_blank" href="https://forum.middlemanapp.com/">Community Forum</a>
        </li>
      <li class="doc-item">
        <a target="_blank" href="https://github.com/middleman/middleman">GitHub Repository</a>
        </li>
      <li class="doc-item">
        <a href="/community/built_using_middleman/">Sites Built Using Middleman</a>
        </li>
    </ul>
  </div>
</div>

    </nav>

    <main class="main" role="main" data-waypoint="main">
      <h1 id="improving-cacheability">Improving Cacheability</h1>

<p>To make your website render as quickly as possible, you should serve any
assets, like JavaScript, CSS, or images, with proper headers that instruct web
browsers to <a href="https://code.google.com/speed/page-speed/docs/caching.html">cache them for a very long
time</a>. This means
that when users visit your site again (or even just go to another page in your
site) they don&#39;t have to re-download those assets. However, setting a
far-future <code>Expires</code> or <code>Cache-Control</code> header can cause problems when you
change your assets but users are still using their cached versions. Middleman
has two approaches to solve this problem for you.</p>

<h2 id="uniquely-named-assets">Uniquely-named assets</h2>

<p>The most effective technique for preventing users from using outdated files is
to change the asset&#39;s filename every time you change one of your assets. Since
that would be a pain to do by hand, Middleman comes with an <code>:asset_hash</code>
extension that does it for you. First, activate the extension in your
<code>config.rb</code>:</p>

<pre><code class="ruby">activate :asset_hash
</code></pre>

<p>Now, refer to your assets as normal, with their original filename. You can use
helpers like <code>image_tag</code> as well. However, when your site is built, each asset
will be produced with a bit of extra text at the end of the filename that is
tied to the content of the file, and all of your other files (HTML, CSS,
JavaScript, etc) will be changed to reference that unique-ified filename
instead of the original one. Now you can serve your assets with a &quot;never
expire&quot; policy, but be sure that when you change them, they&#39;ll show up as a
different filename.</p>

<p>However, because this extension works by rewriting your files to reference the
renamed assets, it&#39;s possible the extension might mess up and miss a reference,
or do something you don&#39;t want to your code. In that case, you might have to
fall back to the older cache buster method.</p>

<p>If you want to exclude any files from being renamed, pass the <code>:ignore</code> option
when activating <code>:asset_hash</code>, and give it one or more globs, regexes, or procs
that identify the files to ignore. Likewise, you can pass an <code>:exts</code> option to
change which file extensions are renamed.</p>

<h2 id="configuring-your-server">Configuring your server</h2>

<p>Configuring your server to use far-future <code>Expires</code> and <code>Cache-Control</code> headers
is different depending on which server you use. See Google&#39;s <a href="https://code.google.com/speed/page-speed/docs/caching.html">page speed
docs</a> for links on
how to configure your particular server, and run <a href="https://code.google.com/speed/page-speed/docs/extension.html">Google Page
Speed</a> or
<a href="https://addons.mozilla.org/en-US/firefox/addon/yslow/">YSlow</a> to check that
you&#39;ve configured things correctly.</p>

    </main>
  </div>

    <footer class="footer" data-waypoint="footer" role="contentinfo">
  <div class="wrap-container">
    <div class="footer-column">
      <article class="footer-site-information">
        <p>
          &copy; 2011&ndash;2015 <a href="//awardwinningfjords.com">Thomas Reynolds</a>
        </p>
        <p class="footer-open-source-credit">
          Maintained by the <a href="//github.com/orgs/middleman/people">core team</a> with help from
            <a href="//github.com/middleman/middleman/graphs/contributors">contributors</a>.
        </p>
      </article>
      <article class="footer-contact">
        <ul class="footer-contact-list">
          <li class="footer-contact-list-item twitter-link">
            <a href="//twitter.com/middlemanapp">@middlemanapp</a>
          </li>
          <li class="footer-contact-list-item github-link">
            <a href="//github.com/middleman/middleman">GitHub</a>
          </li>
        </ul>
      </article>
    </div>
    <div class="footer-column footer-right">
      <a href="https://formkeep.com?utm_source=middleman">
        <span class="footer-formkeep-logo"></span>
      </a>
      <p class="footer-credit">
        FormKeep provides

        <a href="https://formkeep.com/?utm_source=middleman">form endpoints for Middleman sites</a>.
      </p>
    </div>
  </div>
</footer>

    <script src="/javascripts/site.js"></script>
    <script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-90027-21']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
<script>
  var _gauges = _gauges || [];
  (function() {
    var t   = document.createElement('script');
    t.type  = 'text/javascript';
    t.async = true;
    t.id    = 'gauges-tracker';
    t.setAttribute('data-site-id', '4ef39d56613f5d017b000004');
    t.src = '//secure.gaug.es/track.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(t, s);
  })();
</script>
  </body>
</html>
